<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste Escola</title>
</head>
<body>
    <h1>Teste Escola</h1>

    <h2>Adicionar Aluno</h2>
    <input type="text" id="nomeAluno" placeholder="Nome do aluno">
    <button onclick="adicionarAluno()">Adicionar</button>
    <div id="resultadoAluno"></div>

    <h2>Atribuir Nota</h2>
    <input type="number" id="alunoIdNota" placeholder="ID do aluno">
    <input type="number" id="disciplinaIdNota" placeholder="ID da disciplina">
    <input type="number" step="0.1" id="valorNota" placeholder="Nota 0-10">
    <button onclick="atribuirNota()">Enviar Nota</button>
    <div id="resultadoNota"></div>

    <h2>Atribuir Presença</h2>
    <input type="number" id="alunoIdPresenca" placeholder="ID do aluno">
    <input type="number" id="quantidadePresenca" placeholder="Quantidade" value="1">
    <button onclick="atribuirPresenca()">Adicionar Presença</button>
    <div id="resultadoPresenca"></div>

    <h2>Listar Alunos</h2>
    <button onclick="listarAlunos()">Atualizar Lista</button>
    <pre id="listaAlunos"></pre>

    <h2>Listar Notas</h2>
    <button onclick="listarNotas()">Atualizar Lista</button>
    <pre id="listaNotas"></pre>

    <script>
        const urlBase = "http://127.0.0.1:5000";

        async function adicionarAluno() {
            const nome = document.getElementById("nomeAluno").value;
            const res = await fetch(`${urlBase}/alunos`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({nome})
            });
            const data = await res.json();
            document.getElementById("resultadoAluno").innerText = JSON.stringify(data, null, 2);
        }

        async function atribuirNota() {
            const aluno_id = parseInt(document.getElementById("alunoIdNota").value);
            const disciplina_id = parseInt(document.getElementById("disciplinaIdNota").value);
            const valor = parseFloat(document.getElementById("valorNota").value);
            const res = await fetch(`${urlBase}/notas`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({aluno_id, disciplina_id, valor})
            });
            const data = await res.json();
            document.getElementById("resultadoNota").innerText = JSON.stringify(data, null, 2);
        }

        async function atribuirPresenca() {
            const aluno_id = parseInt(document.getElementById("alunoIdPresenca").value);
            const presencas = parseInt(document.getElementById("quantidadePresenca").value);
            const res = await fetch(`${urlBase}/presencas`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({aluno_id, presencas})
            });
            const data = await res.json();
            document.getElementById("resultadoPresenca").innerText = JSON.stringify(data, null, 2);
        }

        async function listarAlunos() {
            const res = await fetch(`${urlBase}/alunos`);
            const data = await res.json();
            document.getElementById("listaAlunos").innerText = JSON.stringify(data, null, 2);
        }

        async function listarNotas() {
            const res = await fetch(`${urlBase}/notas`);
            const data = await res.json();
            document.getElementById("listaNotas").innerText = JSON.stringify(data, null, 2);
        }
    </script>
</body>
</html>
